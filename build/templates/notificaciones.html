<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Notificaciones - Sistema de Alertas</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/notificaciones.css') }}">  
</head>

<body>
    <!-- Banner superior -->
    <div class="banner">
        <div class="banner-left">
            <span class="icono-baner"></span>
            <span class="notificaciones">Notificaciones Masivas</span>
        </div>
        <div class="banner-right">
            <span class="welcome-text">Bienvenido(a)</span>
            <span class="user-dropdown-toggle user-name" onclick="toggleUserDropdown()">{{ usuario }}</span>
            <div class="user-dropdown" id="userDropdown">
                <ul>
                    <li><a href="{{ url_for('change_password') }}">Cambiar contrase√±a</a></li>
                    <li><a href="{{ url_for('logout') }}">Cerrar sesi√≥n</a></li>
                </ul>
            </div>
        </div>
    </div>

    <!-- Barra de men√∫ con b√∫squeda -->
    <div class="menu-bar">
        <ul class="menu-list">
            <li><a href="{{ url_for('home') }}">Inicio</a></li>
            <li><a href="{{ url_for('grupos') }}">Grupos</a></li>
            <li class="active"><a href="{{ url_for('notificaciones') }}">Notificaciones</a></li>
            <li><a href="{{ url_for('redactar') }}">Redactar</a></li>
            <li><a href="{{ url_for('ayuda') }}">Ayuda</a></li>
            <!-- Apartado de b√∫squeda -->
            <li class="menu-search">
                <form onsubmit="return false;">
                    <input id="searchInputN" type="text" placeholder="Buscar notificaciones...">
                </form>
            </li>
        </ul>
    </div>

    <!-- Panel de Emergencias -->
    <div class="panel-emergencias">
        <div class="panel-header">
            <span class="icono-emergencias"></span>
            <span class="panel-title">EMERGENCIAS Y NOTIFICACIONES</span>
        </div>
        <div class="panel-content">
            <ul id="mensajesList" class="mensajes-list">
                <!-- Ejemplo de notificaciones -->
                <li class="mensaje-prioridad-alta">
                    <div class="mensaje-info">
                        <div class="mensaje-texto">üö® ALERTA: Interrupci√≥n programada del servicio el 15 de Mayo</div>
                        <div class="mensaje-metadata">
                            <span>Enviado: 10/05/2024 14:30</span>
                            <span>Por: Sistema Central</span>
                            <span class="badge bg-danger">Alta Prioridad</span>
                        </div>
                    </div>
                    <div class="mensaje-actions">
                        <button class="btn btn-outline-primary btn-sm">Ver detalles</button>
                        <button class="btn btn-outline-danger btn-sm">Eliminar</button>
                    </div>
                </li>

                <li class="mensaje-prioridad-media">
                    <div class="mensaje-info">
                        <div class="mensaje-texto">‚ö†Ô∏è Mantenimiento preventivo de servidores</div>
                        <div class="mensaje-metadata">
                            <span>Enviado: 09/05/2024 09:15</span>
                            <span>Por: Departamento T√©cnico</span>
                            <span class="badge bg-warning">Media Prioridad</span>
                        </div>
                    </div>
                    <div class="mensaje-actions">
                        <button class="btn btn-outline-primary btn-sm">Ver detalles</button>
                        <button class="btn btn-outline-danger btn-sm">Eliminar</button>
                    </div>
                </li>

                <li class="mensaje-prioridad-baja">
                    <div class="mensaje-info">
                        <div class="mensaje-texto">üì¢ Nueva actualizaci√≥n disponible para la aplicaci√≥n</div>
                        <div class="mensaje-metadata">
                            <span>Enviado: 08/05/2024 16:45</span>
                            <span>Por: Equipo de Desarrollo</span>
                            <span class="badge bg-success">Baja Prioridad</span>
                        </div>
                    </div>
                    <div class="mensaje-actions">
                        <button class="btn btn-outline-primary btn-sm">Ver detalles</button>
                        <button class="btn btn-outline-danger btn-sm">Eliminar</button>
                    </div>
                </li>

                <li class="mensaje-prioridad-alta">
                    <div class="mensaje-info">
                        <div class="mensaje-texto">üö® Falla en el sistema de env√≠os - Se est√° trabajando en la soluci√≥n
                        </div>
                        <div class="mensaje-metadata">
                            <span>Enviado: 07/05/2024 11:20</span>
                            <span>Por: Soporte T√©cnico</span>
                            <span class="badge bg-danger">Alta Prioridad</span>
                        </div>
                    </div>
                    <div class="mensaje-actions">
                        <button class="btn btn-outline-primary btn-sm">Ver detalles</button>
                        <button class="btn btn-outline-danger btn-sm">Eliminar</button>
                    </div>
                </li>

                <!-- Las notificaciones din√°micas desde Flask -->
                {% for msg in messages %}
                <li>
                    <div class="mensaje-info">
                        <div class="mensaje-texto">{{ msg }}</div>
                        <div class="mensaje-metadata">
                            <span>Enviado: {{ loop.index }}/05/2024</span>
                            <span>Por: Sistema</span>
                        </div>
                    </div>
                    <div class="mensaje-actions">
                        <button class="btn btn-outline-primary btn-sm">Ver detalles</button>
                        <button class="btn btn-outline-danger btn-sm">Eliminar</button>
                    </div>
                </li>
                {% endfor %}
            </ul>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-left">
            <div class="footer-column">
                <a href="https://www.etecsa.cu/">Nuestra Empresa</a>
                <a href="https://www.etecsa.cu/es/noticias/nota-informativa">Noticias</a>
            </div>
            <div class="footer-column">
                <a
                    href="https://www.google.com/url?sa=t&source=web&rct=j&opi=89978449&url=https://www.youtube.com/channel/UCL0haKOFpVzhnKW3xSZJx9g/videos&ved=2ahUKEwjEl7nGz9uNAxX9nK8BHXnFML8QFnoECBUQAQ&usg=AOvVaw1mq5OFoaKhA0cx4T7ZyC-k">Multimedia</a>
                <a href="https://portal.etecsa.cu/portalApp/listado">Servicios Internos</a>
            </div>
        </div>
        <div class="footer-right">
            <img src="{{ url_for('static', filename='images/icono_logo.png') }}" alt="Logo">
            <span>&copy; {{ year }} Empresa de Telecomunicaciones de Cuba S.A (ETECSA)</span>
        </div>
    </footer>

    <!-- Bootstrap JS Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Script de b√∫squeda en tiempo real para Emergencias -->
    <script>
        document.getElementById('searchInputN').addEventListener('input', function () {
            const filter = this.value.toLowerCase();
            const liItems = document.querySelectorAll('#mensajesList li');
            liItems.forEach(function (li) {
                const texto = li.querySelector('.mensaje-texto').textContent.toLowerCase();
                if (texto.indexOf(filter) > -1) {
                    li.style.display = '';
                } else {
                    li.style.display = 'none';
                }
            });
        });

        function toggleUserDropdown() {
            const dropdown = document.getElementById("userDropdown");
            dropdown.style.display = dropdown.style.display === "block" ? "none" : "block";
        }

        // Cerrar el men√∫ si se hace clic fuera de √©l
        document.addEventListener("click", function (event) {
            const dropdown = document.getElementById("userDropdown");
            const toggle = document.querySelector(".user-dropdown-toggle");
            if (dropdown.style.display === "block" && !dropdown.contains(event.target) && event.target !== toggle) {
                dropdown.style.display = "none";
            }
        });

        // Funcionalidad para botones de eliminar
        document.querySelectorAll('.btn-outline-danger').forEach(button => {
            button.addEventListener('click', function () {
                const mensaje = this.closest('li');
                if (confirm('¬øEst√° seguro de que desea eliminar esta notificaci√≥n?')) {
                    mensaje.style.opacity = '0';
                    setTimeout(() => {
                        mensaje.remove();
                    }, 300);
                }
            });
        });
    </script>
</body>

</html>